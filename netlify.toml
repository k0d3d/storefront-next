# Netlify configuration for Next.js
# IMPORTANT: In Netlify Dashboard, go to Site settings → Build & deploy → Build settings
# and CLEAR/DELETE the "Publish directory" field - leave it empty!
# The Essential Next.js plugin handles this automatically.

[build]
  command = "npx pnpm install --store=node_modules/.pnpm-store && npx pnpm run build"
  # Do NOT set publish - let Next.js plugin handle it

[build.environment]
  NODE_VERSION = "20"
  # Skip Netlify's automatic npm install (we use pnpm in build command)
  NPM_FLAGS = "--version"

# Headers for security
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "SAMEORIGIN"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
